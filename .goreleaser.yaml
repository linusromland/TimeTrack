before:
    hooks:
        - go mod tidy
        - go generate ./...

builds:
    - env:
          - CGO_ENABLED=0
          - PRODUCTION=true
      goos:
          - linux
          - windows
          - darwin
      main: ./cli/main.go
      ldflags:
          - '-X main.version={{.Version}} -X main.commit={{.Commit}} -X main.date={{.Date}} -X TimeTrack/src/oauth.PRODUCTION_CLIENT_ID={{ .Env.GOOGLE_CLIENT_ID }} -X TimeTrack/src/oauth.PRODUCTION_CLIENT_SECRET={{ .Env.GOOGLE_CLIENT_SECRET }}'

archives:
    - format: tar.gz
      name_template: >-
          {{ .ProjectName }}_
          {{- title .Os }}_
          {{- if eq .Arch "amd64" }}x86_64
          {{- else if eq .Arch "386" }}i386
          {{- else }}{{ .Arch }}{{ end }}
          {{- if .Arm }}v{{ .Arm }}{{ end }}
      format_overrides:
          - goos: windows
            format: zip

changelog:
    sort: asc
    filters:
        exclude:
            - '^docs:'
            - '^test:'
# Build instructions
# Have a .env.production file with the following contents:
# ENVIROMENT=production
# GOOGLE_CLIENT_ID=YOUR_PRODUCTION_GOOGLE_CLIENT_ID
# GOOGLE_CLIENT_SECRET=YOUR_PRODUCTION_GOOGLE_CLIENT_SECRET

# Run the following command:
# git tag -a v0.0.0 -m "TAG MESSAGE"

# Run the following command:
# git push origin v0.0.0

# Run the following command:
# ./build.sh
